
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Starter Template for Bootstrap</title>

    <!-- Bootstrap core CSS -->
    <link href="dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <!-- <link href="../../assets/css/ie10-viewport-bug-workaround.css" rel="stylesheet"> -->

    <!-- Custom styles for this template -->
    <link href="starter-template.css" rel="stylesheet">

    <!-- Just for debugging purposes. Don't actually copy these 2 lines! -->
    <!--[if lt IE 9]><script src="../../assets/js/ie8-responsive-file-warning.js"></script><![endif]-->
    <!-- <script src="../../assets/js/ie-emulation-modes-warning.js"></script> -->

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <style>
      .normal {
        font-size: 18px;
        text-align: justify;
      }



      </style>

    <style>
      .heading2 {
        text-align: left;
        font-weight: bold;
        margin-top: 30px;
        margin-bottom: 25px;
      }
      .heading3 {
        text-align: left;
        font-weight: bold;
        margin-top: 25px;
        margin-bottom: 25px;
        font-size: 25px;
      }
      .heading4 {
        text-align: left;
        font-weight: bold;
        margin-top: 23px;
        margin-bottom: 23px;
        font-size: 23px;
      }
      .heading5 {
        text-align: left;
        margin-top: 22px;
        margin-bottom: 20px;
        font-size: 20px;
        font-style: italic;
        font-weight: bold;
      }


      </style>
    <style>
      .figure {
        text-align: center;
        margin-top: 10px;
        margin-bottom: 20px;
        font-size: 18px;
        font-weight: bold;
      }
      .code-intext {
            font-family: 'Lucida Console', monospace;
            font-size: 16px;
            font-weight: bold;
            line-height: 1;
      }
      .code-courier {
            font-family: 'Courier New', monospace;
            line-height: 1;
            padding: 0px 30px;
            font-size: 16px;
            line-height: 1;
        }
      .ref {
        text-align: left;
        font-size: 18px;
        padding: 0px 10px;
      }
      </style>
  </head>

  <body>

    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">Project name</a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
            <li class="active"><a href="#">Home</a></li>
            <li><a href="#intro">Introduction</a></li>
            <li><a href="#high">High Level Design</a></li>
            <li><a href="#design">Design</a></li>
            <li><a href="#result">Results and Analysis</a></li>
            <li><a href="#conclusion">Conclusions</a></li>
            <li><a href="#Team">Team Members</a></li>
            <li><a href="#ref">References</a></li>
            <li><a href="#AppendixA">Appendix</a></li>
            <!--<li><a href="#AppendixB">Appendix B</a></li>
            <li><a href="#AppendixC">Appendix C</a></li>-->
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">

      <div class="starter-template">
        <h1>ECE5730 Remote-controlled Robot with Electromagnet</h1>
        <p class="lead" style="font-size: 20px;">By Wenyi Fu (wf223) and Klora Wang (hw768)</p>
        <p class="normal" style="text-align: center;">Dec 12, 2023</p>
      </div>

      <hr>
      <div class="center-block" style="text-align:center;">
        <img class="img-rounded" src="pics/robot.jpg" alt="Generic placeholder image" width="550" height="400">
        <h4 style="text-align:center; margin-top: 15px;">Remote-controlled Robot with Electromagnet</h4>
        </div>

      <hr>
      
      <div class="center-block">
          <iframe width="640" height="400" src="https://www.youtube.com/embed/G_COTIjia5Q" style="border: 0;" allowfullscreen></iframe>
          <h4 style="text-align:center;">Demonstration Video</h4>
      </div>

      <hr id="intro">

      <div class="normal">
              <h2 class="heading2">Introduction</h2>
              <p>Our project innovates an interactive electromagnet car that can be wirelessly directed via a laptop to control, collect magnetic objects, and deliver them to designated locations as commanded by the users.</p>
              <p>We engineered an electromagnet car with the capability to be remotely controlled using Wi-Fi, aiming to streamline the process of magnetic object retrieval and placement. The motivation behind this project was to enhance efficiency in scenarios where precise and controlled movement of magnetic items is required. By leveraging wireless technology, the car can be maneuvered with precision to designated spots, thereby automating the collection and transportation of magnetic materials. This innovation not only serves to reduce manual labor but also introduces a level of precision and control that manual handling cannot achieve, making it a valuable asset in various practical applications.</p>
      </div>

    <hr id='high'>
      <div class="normal">
        <h2 class="heading2">High Level Design</h2>
          <p>The concept for our project stemmed from the need to automate and simplify the process of transporting magnetic objects in various settings, such as manufacturing floors, educational labs, or clean-up sites. The idea was inspired by the increasing demand for remote-controlled and automated systems in industry and education for tasks that require precision and can be tedious or hazardous for humans. Furthermore,with more research on this project, remote operations can be conducted in a variety of implementation environments, such as nuclear reactor, space robots collecting metals. </p>
          <p>The project idea was basically influenced by advancements in the Internet of Things and robotics. Existing ubiquity of Wi-Fi technology, and the combination of using RP2040 and motor driver. They all provided a solid foundation for the project's inception. </p>

          <ul>
            <li style="margin-top: 20px; margin-bottom: 15px; font-size: 22px;"><b>Background math</b></li></ul>
            <p style="margin-left: 40px;">Calculations were made to determine the necessary current turns for the electromagnet, ensuring it operates within safe power limits while maintaining functionality. Besides, we also calculate the PWM power sent to the motor control so that our motor can drive the wheels at our desired speed. Furthermore, with resistors and capacitors carefully chosen in the electromagnet control circuit, we can realize the switching status of the magnet by proper forward bias of the MOSFET.</p>
              
          <ul>
            <li style="margin-top: 20px; margin-bottom: 15px; font-size: 22px;"><b>Logical structure</b></li></ul>
            <p style="margin-left: 40px;">The project's logical structure is designed to ensure the efficient and responsive operation of the interactive electromagnet car. It comprises several key components:</p>
            
          <div style="margin-left: 40px;">
            <ul>
          
              <li style="list-style-type: circle; margin-top: 15px; margin-bottom: 10px; font-size: 20px;"><b>Directional controls</b></li></ul>
              <p style="margin-left: 40px;"><b><i>Forward Movement</i></b>: Allows the user to move the car forward. This basic command is crucial for navigating the car toward magnetic objects or designated locations. </p>
              <p style="margin-left: 40px;"><b><i>Left and Right Turn (Forward)</i></b>: Enables precise steering while the car is moving forward. Users can navigate the car around obstacles or through complex paths. </p>
              <p style="margin-left: 40px;"><b><i>Backward Movement</i></b>: Facilitates the reverse motion of the car. This control is essential for repositioning or maneuvering in tight spaces. 
              <p style="margin-left: 40px;"><b><i>Left and Right Turns (Backward)</i></b>: Similar to forward turns, these controls allow for precise steering when the car is moving backward.</p>
              
            <ul>
              <li style="list-style-type: circle; margin-top: 15px; margin-bottom: 10px; font-size: 20px;"><b>Electromagnet activation</b></li></ul>
              <p style="margin-left: 40px;"><b><i>On/Off Toggle</i></b>: A simple control to activate or deactivate the electromagnet. When activated, the car can pick up magnetic objects; deactivation allows for the release of these objects at desired locations.</p>

            
            </div>

            

      </div>

    <hr id='design'>

      <div style="text-align:left;">
              <h2 class="heading2">Design</h2>
              <div class="normal">
                <h3 class="heading3">Hardware Design</h3>
                  <h4 class="heading4">i. Overview</h4>
                      <p><b>Figure 1</b> shows the connection implemented on the plastic sheet, where there are DC motors, electromagnet, motor controller, Pico W, etc. In the figure on the right, it can be seen that the two breadboards containing motor and electromagnet control circuits are installed on the top layer of the plastic board. Additionally, in the middle of the figure, we can observe that the electromagnet is installed in front of the robot, which enhances the convenience to grab the metal on the ground, and in the right, it can be observed that the two DC motors are assembled on the bottom of the car, driving those two wheels.</p>
                      <div style="display: flex; justify-content: center; align-items: center; flex-wrap: wrap; margin-top: 20px; margin-bottom: 20px;">
                        <img class="img-rounded" src="pics/robot1.jpg" alt="Generic placeholder image" width="400" height="300" style="margin-right: 10px;">
                        <img class="img-rounded" src="pics/robot2.jpg" alt="Generic placeholder image" width="400" height="300" style="margin-right: 10px;">
                        <img class="img-rounded" src="pics/robot4.jpg" alt="Generic placeholder image" width="220" height="300">
                        </div>
                        <p class="figure">Figure 1. Mechanical Connection of the Robot</p>
                      

                      <p><b>Figure 2</b> displays the overall hardware connection of our final project, Remote-controlled robot with electromagnet implemented on RP2040. The microcontroller used is the Pico W, as it has the Wi-Fi connection module, which is required in the remote control part of our project. And we use two sets of batteries to power the device, one is 4.5V to power the Pico W by connecting to VSYS and GND pins, and the other is 6V to power the motor and the electromagnet. In the following sections, detailed hardware design will be fully illustrated, including motor and electromagnet control circuits. 
                      </p>
                      
                      <div style="text-align:center; margin-top: 20px; margin-bottom: 20px;">
                        <img class="img-rounded" src="pics/overall-hardware.png" alt="Generic placeholder image" width="1000" height="480">
                        <p class="figure">Figure 2. Hardware Connection of the Robot</p>
                      </div>

                  <h4 class="heading4">ii. Motor Control Circuit</h4>
                      <p>We applied the motor control chip as the H bridget to control the wheel to move forward and backward. In this project, Sparkfun TB6612FNG dual-channel motor controller is chosen as the motor control module, and the pinout diagram is listed in <b>Figure 3</b>. According to the hookup guide <a href="#reference1">[1]</a>, the motor controller can be connected to the Pico W to realize certain functions, which is shown in <b>Figure 2</b>. VM is connected to the 6V power supply, used for powering the motors; VCC is connected to the 3.3 Volts output from the Pico W for powering the controller. STNDBY basically acted as a chip select pin, so it was also connected to the 3.3 Volts output from the Pico W to maintain the control of the motors. In addition, for the motor A, we select available pins, GPIO 3 and GPIO 4 for INA1 and INA2 respectively, and then GPIO 10 for PWMA, continuing the previous LED setting. The Aout1 and Aout2 outputs are connected from the motor controller to the DC motor. As for the motor B, we select GPIO 7 and GPIO 8 for INB1 and INB2 respectively, and GPIO 11 for PWMB. The mechanical design of the motor ciucuit in shown in <b>Figure 4</b> on the bottom breadboard. </p>

                      <div class="row">
                      <div class="col-md-6" style="text-align:center; margin-top: 20px; margin-bottom: 20px;">
                        <img class="img-rounded" src="pics/controller.jpg" alt="Generic placeholder image" width="240" height="240">
                        <p class="figure" style="text-align: center;">Figure 3. TB6612FNG Motor Controller Pinout Diagram</p>
                        </div>
                      
                        <div class="col-md-6" style="text-align:center; margin-top: 20px; margin-bottom: 20px;">
                          <img class="img-rounded" src="pics/robot3.jpg" alt="Generic placeholder image" width="400" height="300">
                          <p class="figure" style="text-align: center;">Figure 4. Circuits Construction</p>
                        </div>
                        
                        </div>

                  <h4 class="heading4">iii. Electromagnet control circuit </h4>
                      <p>Since the circuit shown in <b>Figure 5</b> could drive the motor in Lab 3, it might be able to drive electromagnet as well, so we tried this circuit and it performed perfectly. Consequently, the circuit was implemented by only changing the motor into an electromagnet. When the input signal on the left is set to high, indicating 3.3V from the microcontroller, the transistor inside <b>4N35</b> module the MOSFET <b>IRF640</b> can be forward biased, and then the electromagnet can be turned on. </p>

                      <div style="text-align:center; margin-top: 20px; margin-bottom: 20px;">
                        <img class="img-rounded" src="pics/eletro-control.jpg" alt="Generic placeholder image" width="450" height="350">
                        <p class="figure">Figure 5. Electromagnet Drive Circuit</p>
                      </div>
                      

                      

                <h3 class="heading3">Program Design</h3>
                  <h4 class="heading4">i. Program Overview</h4>
                  
                    <div style="margin-top:10px; margin-bottom:10px; font-size: 22px;">
                    <ul><li><b>Motor control</b></li></ul>
                      </div>
                    <p style="margin-left: 40px;">Several motor control functions were defined, including <span class="code-intext">Stop(), Forward(), Reverse(), TurnLeft(), TurnRight(), ReverseTurnleft(), and ReverseTurnRight(),</span> which can be applied in the PWM interrupt service routine to control the moving direction of the remote-control robot. On the basis of Lab 3 assignment, there was only one PWM GPIO set, so in this project, we needed to initialize another PWM GPIO, according to the Pico W datasheet. Additionally, in the PWM ISR, we defined 7 states to correspond to each moving direction, where the state would be switched based on the UDP packets received from the Wi-Fi wireless connection channel. In this case, GPIO 10 and 11 were set as the PWM channel  of the motors according to <b>Figure 6</b>, and GPIO 3, 4, 7, 8 were chosen to move the motors forward or backward. </p>

                    <div style="text-align:center; margin-top: 20px; margin-bottom: 22px;">
                      <img class="img-rounded" src="pics/pwm.png" alt="Generic placeholder image" width="850" height="150">
                      <p class="figure">Figure 6. Mapping of PWM channels to GPIO pins on RP2040 <a href="#reference2">[2]</a> </p>
                      </div>


                    <div style="margin-top:10px; margin-bottom:10px; font-size: 22px;">
                      <ul><li><b>Electromagnet control</b></li></ul>
                        </div>
                    
                    <p style="margin-left: 40px;">Since the motor control circuit from Lab 3 has been applied in this module, we only need to set the input signal high, coming from GPIO 17, to turn on the MOSFET <b>IRF640</b>, and later turn on the Electromagnet. Furthermore, we implemented a red LED to indicate the status of the magnet, controlled by programming GPIO 18. </p>

                    

                    <div style="margin-top:10px; margin-bottom:10px; font-size: 22px;">
                      <ul><li><b>Wi-Fi module </b></li></ul>
                        </div>

                    <p style="margin-left: 40px;">Concerning Wi-Fi connection, we consulted with the <a href="https://people.ece.cornell.edu/land/courses/ece4760/RP2040/C_SDK_LWIP/UDP_send_recv/index_udp.html">UDP packet sending program</a> from Prof. Land. Later, we combined the code with the <a href="https://datasheets.raspberrypi.com/picow/connecting-to-the-internet-with-pico-w.pdf">official Wi-Fi connection code</a> shown in the Pico W datasheet. Since it was hard to register the device on the RedRover, we tried to open a hotspot on our mobile phones as the Wi-Fi connection station. However, at first, the Pico W could not be connected to the hotspot, so we applied the Wi-Fi scan program from the Raspberry Pi Company to check the Wi-Fi around us until the name we wanted appeared. Therefore, we could successfully connect to our mobile phone. </p>
                    <p style="margin-left: 40px;">Initially, we sent the characters through the software, UDP Sender/Receiver, to control the internal LED of the microcontroller to see whether it was successful. Furthermore, with the successful implementation of toggling the LED, the Python program would be run on the laptop to establish a UDP socket to send data, and we modified the code to send characters without pressing the <b><i>ENTER</i></b> key on the laptop keyboard. </p>
                    


                  <h4 class="heading4">ii. Program Organization</h4>
                  
                  
                  <div style="margin-top:30px; margin-bottom:10px; font-size: 22px;">
                    <ul><li><b>Program on Pico W </b></li></ul>
                      </div>
                      <div style="margin-left: 40px;">
                      <div class="normal">

                        <h5 class="heading5">Thread 1: protothread_udp_recv</h5>
                          <p>Thread 1 is used to receive UDP packets containing the wheels and electromagnet control instructions, which is set as <span class="code-intext">'w'</span> (forward), <span class="code-intext">'a'</span> (left), <span class="code-intext">'d'</span> (right), <span class="code-intext">'s'</span> (backward), <span class="code-intext">'c'</span> (stop), <span class="code-intext">'k'</span> (electromagnet on), <span class="code-intext">'l'</span> (electromagnet off). The parameter of <span class="code-intext">LAST_STATE</span> will record previous state, and when the previous state is <b><i>Forward</i></b> or <b><i>TurnLeft</i></b> and receiving <span class="code-intext">'d'</span>, the motor will be set to <span class="code-intext">STATE = 4</span>, representing <span class="code-intext">TurnRight()</span>, while when the previous state is <b><i>Reverse</i></b> or <b><i>ReverseTurnLeft</i></b> and receiving <span class="code-intext">'d'</span>, the motor will be set to <span class="code-intext">STATE = 6</span>, representing <span class="code-intext">ReverseTureRight()</span>, and under other similar condition, it will be programed to similar actions, since it ensure that the robot can turn left or right backward when it is generally moving backward. Furthermore, the current state parameter is controlled by <span class="code-intext">STATE</span> and set under all the conditions mentioned above. As for electromagnet control, <span class="code-intext">gpio_put(ELECTRO_CONTROL, 1)</span> function is implemented to turn on the magnet and <span class="code-intext">gpio_put(ELECTRO_CONTROL, 0)</span> is used to turn it off. Additionally, a red LED is applied to demonstrate the current status of the electromagnet, showing it is on or off. At first, this thread only received numbers for testing, represented by LED toggling, which will be fully illustrated in <b><i>Thread 3</i></b> section. Later, it was modified to receive characters by the Python script on the laptop. </p>



                        <h5 class="heading5">Thread 2: protothread_serial </h5>
                          <p>This thread is implemented for testing and debugging, which is a significant proportion of this project, and without which the efficiency cannot be ensured. It is basically modified according to <a href="https://github.com/vha3/Hunter-Adams-RP2040-Demos">Prof. Adams's demo code</a>. When we were in the starting phase of motor control implementation, the serial interface should be used to debug and test the movement of the wheel. </p>
                          <p>Moreover, the actions and control number is shown in the PuTTY window by the function:</p>
                          <p class="code-courier" style="padding:0px 70px;line-height: 1.5;">sprintf(pt_serial_out_buffer, "0 duty cycle, 1 forward motor, 2 reverse motor, 3 turn left, 4 turn right, 5 turn on electro, 6 turn off: ");</p>
                          <p>Therefore, users are able to debug the code after uploading the program into Pico W. Thereafter, when the motor and electromagnet can perform well, this thread can alsso be commented out to simplify the program. </p>


                        <h5 class="heading5">Thread 3: protothread_toggle_cyw43</h5>
                          <p>This thread is used for testing as well, and it can be commented out as long as the UDP packets can be successfully sent between the Pico W and the laptop. Initially, it is shown in <b>Figure 7</b> that the Microsoft packet logger named UDP Sender/Receiver is opened on the laptop to send UDP data to the Pico W, by setting up the IP address and port number, and the Pico W can receive data by implementing <b><i>Thread 1</i></b>. To prove that the Pico W has received the message, the function <span class="code-intext">protothread_toggle_cyw43()</span> is implemented to test the result. Therefore, when the number of '100' is received by the Pico W, the blinking frequency of the internal LED would be changed, and with the increase of the sending number, the frequency would be increased. Therefore, with <b><i>Thread 3</i></b>, the Wi-Fi connection can be perfectly verified and all the following processes can be made after this. </p>

                          <div style="text-align:center; margin-top: 20px; margin-bottom: 22px;">
                            <img class="img-rounded" src="pics/udp.png" alt="Generic placeholder image" width="500" height="400">
                            <p class="figure">Figure 7. UDP - Sender/Receiver</p>
                            </div>



                        <h5 class="heading5">PWM ISR</h5>
                        <p>First, all the 7 motor movements are defined as individual functions, which will be easy to call later in the PWM ISR. For instance, the <span class="code-intext">Forward()</span> function is shown below, and others with the similar structure: </p>
                        <div class="code-courier" style="padding: 0px 70px">
                            <p>void Forward(int speed) {
                            <p>gpio_put(MOTOR1_SELECT1, 0);
                            <p>gpio_put(MOTOR1_SELECT2, 1);
                            <p>gpio_put(MOTOR2_SELECT1, 0);
                            <p>gpio_put(MOTOR2_SELECT2, 1);
                            <p>control = speed;
                            <p>control1 = speed;
                            <p>}
                          

                          </div>

                        <p>Inside the PWM ISR, we separate the conditions by detecting the value of <span class="code-intext">STATE</span>. If <span class="code-intext">STATE</span> is equal to 0, it is the initialized stage, which is <b><i>Stop</i></b> state, and if <span class="code-intext">STATE</span> is equal to 1, it will set the motors to <b><i>Forward</i></b> state. All the control conditions are fully listed in <b>Figure 8</b>. With the actions determined, the PWM signal value will be sent to the corresponding GPIO by the following code, where we only apply one <span class="code-intext">slice_num</span> with two channels, <span class="code-intext">PWM_CHAN_A & PWM_CHAN_B</span>: </p>

                        <div class="code-courier" style="padding: 0px 70px">
                          <p>pwm_set_chan_level(slice_num, PWM_CHAN_A, control);
                          <p>pwm_set_chan_level(slice_num, PWM_CHAN_B, control1);

                        </div>

                        <div id="Figure8">
                        <div style="text-align:center; margin-top: 20px; margin-bottom: 22px;">
                          <img class="img-rounded" src="pics/contro-state.png" alt="Generic placeholder image" width="900" height="100">
                          <p class="figure">Figure 8. PWM Control State</p>
                          </div>
                          </div>

                        <h5 class="heading5">Main program</h5>
                        <p>In the main program, we first need to set up the Wi-Fi connection between the Pico W and the laptop. If the Wi-Fi connection is achieved, a green LED will be turned on to indicate this status. After the connection, the UDP packet sending process will be initialized and all the GPIO and PWM ISR will be established. Furthermore, we can complete the main program by adding all the threads we want.</p>


                      
                      </div>
                      </div>




                  <div style="margin-top:30px; margin-bottom:10px; font-size: 22px;">
                    <ul><li><b>Program on Laptop </b></li></ul>
                      </div>
                      <div style="margin-left: 40px;">
                      <h5 class="heading5">sending.py</h5>
                      <p>With the successful implementation of toggling the internal LED through Wi-Fi connection, the Python script was created on the laptop to automatically connect to the IP address of the Pico W. Instead of pressing the <b><i>ENTER</i></b> key on the laptop, an easier way should be implemented to send control instructions through the wireless channel. Hence, the function <span class="code-intext">getch.getch()</span> can be applied to ensure not waiting for pressing <b><i>ENTER</i></b> key. After this modification, a Python port can be opened in the VSCode terminal by setting up the corresponding IP address and port number, so we can directly type the command characters into the terminal window without pressing <b><i>ENTER</i></b> key, which enhance the real-time control capabilities of the robot. </p>
                      
                     </div>
                    
                </div>

        </div>
      
    
    <hr id='result'>

      <div style="text-align:left;">
              <h2 class="heading2">Results and Analysis</h2>
              <div class="normal">
                <h3 class="heading3">Results</h3>
                <p>The project was overall a success; the system could respond quickly when instructions were sent from the laptop and it was also user-friendly with a simple interface. As shown in the demo video, the main functionality of the remote control robot was well realized, with a delay which was approximately less than half second. During the demo, when <span class="code-intext">'w'</span> was pressed on the laptop keyboard, the robot was able to move forward, when <span class="code-intext">'s'</span> was pressed, it could move backward, and etc. Furthermore, characters <span class="code-intext">'k'</span> or <span class="code-intext">'l'</span> could be used to turn on or off the electromagnet. However, only the open-loop control algorithm had been applied on the current digital system, and since the PID control algorithm had not been implemented, the two wheels might have different angular speeds, which would cause inaccuracy in motor control and need to be adjusted manually. </p>

                <h3 class="heading3">Analysis</h3>
                <ul>
                  <li class="heading5"><b>Error 1: Wrong connection with motor control chip</b></li></ul>
                  <p style="margin-left: 40px;">At first, the motors were not working after connecting the motor control module with the Pico W. Later, it was found that the wire connecting STNDBY pin and the VCC pin of the microcontroller was not linked acting like the function of chip selection, which led to the failure in motor control.  </p>
                <ul>
                  <li class="heading5"><b>Error 2: PWM control</b></li></ul>
                  <p style="margin-left: 40px;">After adding another PWM signal GPIO, the two could not function properly at the same time. Later, it was discovered that the GPIO number should be carefully chosen before the <b>PWM ISR</b> establishment. As it was shown in <b><a href="#Figure8">Figure 8</a></b> in the PWM ISR section, if we wanted to use one <span class="code-intext">slice_num</span> with two channels, we should choose the GPIO number based on the table listed in the RP2040 datasheet. Therefore, with this modification, we could successfully set up the PWM control of the motors. </p>
                <ul>
                  <li class="heading5"><b>Error 3: Wi-Fi connection</b></li></ul>
                  <p style="margin-left: 40px;">When configuring the Wi-Fi connection between the Pico W and the laptop, our initial attempt to connect them via the common Wi-Fi network 'RedRover' was unsuccessful. We discovered that connecting to 'RedRover' required a complex registration process. After seeking advice from teaching assistants and professors, we opted to simplify the process by creating a hotspot, ensuring a direct Wi-Fi connection between our laptop and the Pico W. Furthermore, we applied the <a href="https://github.com/raspberrypi/pico-examples/tree/master/pico_w/wifi/wifi_scan">Wi-Fi scan</a> code from the official Github resources to check the status of all the networks in the nearby regions, and then we were able to connect the device to the network. </p>
                <ul>
                  <li class="heading5"><b>Error 4: Mistake in electromagnet connection </b></li></ul>
                  <p style="margin-left: 40px;">As we neared the completion of our project, we scheduled a comprehensive re-evaluation of all functionalities following a brief pause. Unexpectedly, we encountered an issue where the electromagnet showed no magnetic response despite the system being powered on and receiving the PWM signal triggered by the keyboard. Initially, we tested the electromagnet directly with a power generator, but to no avail. Subsequently, we checked the PWM signal from the Pico W using a signal generator, which appeared to be functioning correctly.</p>
                  <p style="margin-left: 40px;">Concerned about potential defects in the electromagnet, we reordered two additional units as replacements. However, upon a detailed inspection the next day, we discovered that the issue was caused by an incorrect connection: one terminal of the electromagnet was connected to the negative pole of the power, which was supposed to connect to the positive pole and this mistake prevented the electromagnet from operating. After rectification, the robot could perform perfectly. </p>



                
              



              </div>
        </div>



    <hr id='conclusion'>

      <div class="normal">
              <h2 class="heading2">Conclusions</h2>
              <p>It can be concluded that this project of a remote control robot was overall a success, although there were many challenges encountered. Upon analyzing our design, we find that the results closely align with our expectations, demonstrating the system's robustness and effectiveness. Reflecting on the process, we would consider implementing a PID control algorithm in future iterations to enhance precision and reduce the response time. Moreover, it can be considered to implement the automatic design of this device without any manual adjustment. For instance, the robot can be programmed to automatically search for the metal in the vicinity and turn on the electromagnet to grab the objects. As it is inspired from remote-controlled space robot, other functions can also be added into this project in the future, including connecting through other wireless channels, installing robotic arms for picking up objects, powering by solar battery, etc, which can benefit remote control tasks or even space operations.</p>
              <p>Besides, our design adhered to applicable standards by incorporating proven methodologies and by referencing established intellectual property with appropriate usage. For the intellectual property consideration, we referenced the programs of Prof. Adams and Prof. Land, for configuring PWM GPIO, Wi-Fi connection and serial interface. For example, we built out electromagnet control circuits based on the motor control circuit we had learnt from Prof. Adams in <a href="https://vanhunteradams.com/Pico/Helicopter/MotorCircuit.html">Lab 3: PID control of a 1D helicopter</a>, and we reconstructed the Wi-Fi control program based on Prof. Land's<a href="https://people.ece.cornell.edu/land/courses/ece4760/RP2040/C_SDK_LWIP/UDP_send_recv/index_udp.html"> UDP receiving program</a> and <a href="https://datasheets.raspberrypi.com/picow/connecting-to-the-internet-with-pico-w.pdf">the official configuration example from Raspberry Pi company </a><a href="#reference3">[3]</a>. Additionally, our project did not involve reverse-engineering any existing design. Instead, we developed our system based on fundamental principles and concepts taught in the course, ensuring originality in our approach.</p>
      </div>

    
    <!--=================== Team members ====================-->
    <hr id='Team'>
      <div class="row">
            <h2 class="heading2">Team Members</h2>
            
            <div class="col-md-6" style="font-size:16px; text-align: center;">
                <img class="img-rounded" src="pics/wf223.jpg" alt="Generic placeholder image" width="400" height="400">
                <h3>Wenyi Fu</h3>
                <p class="lead">wf223@cornell.edu</p>
                <p>Design Motor Control Circuit and Program</p>
                <p>Design Electromagnet Control Circuit and Program </p>
                <p>Wi-Fi Configuration</p>
                <p>Design Python Program on Laptop Opening UDP Socket</p>
                <p>Debugging and Testing</p>
                <p>Report and HTML File Writing</p>
            </div>
            <div class="col-md-6" style="font-size:16px;text-align: center;">
                <img class="img-rounded" src="pics/hw768.jpg" alt="Generic placeholder image" width="400" height="400">
                <h3>Klora Wang</h3>
                <p class="lead">hw768@cornell.edu</p>
                <p>Wi-Fi Configuration and Testing</p>
                <p>Debugging and Testing </p>
                <p>Report and HTML File Writing </p>
                  
            </div>
        </div>

    
    <!--=================== References ====================-->
    <hr id='ref'>
      <div class="normal">
          <h2 class="heading2">References</h2>
          <div id="reference1">
          <a href="https://learn.sparkfun.com/tutorials/tb6612fng-hookup-guide">[1] SparkFun Electronics. <i>"TB6612FNG Hookup Guide,"</i>, SparkFun Electronics. </a>[Accessed: Dec. 12, 2023].</div>
          <div id="reference2">
          <a href="https://datasheets.raspberrypi.com/rp2040/rp2040-datasheet.pdf">[2] Raspberry Pi Ltd. <i>"RP2040 Datasheet,"</i>, p. 524. Raspberry Pi Ltd, June 14, 2023. </a>[Accessed: Dec. 11 2023].</div>
          <div id="reference3">
          <a href="https://datasheets.raspberrypi.com/picow/connecting-to-the-internet-with-pico-w.pdf">[3] Raspberry Pi Foundation. <i>"Connecting to the Internet with Pico."</i>, Raspberry Pi Pico Datasheet, Raspberry Pi Foundation, June 14, 2023. p. 9.</a> [Accessed: Dec. 12 2023].</div>
          <a href="https://people.ece.cornell.edu/land/courses/ece4760/RP2040/C_SDK_LWIP/UDP_send_recv/index_udp.html">UDP from Picow to laptop</a><br>
          <a href="https://github.com/raspberrypi/pico-examples/tree/master/pico_w/wifi/wifi_scan">Wi-Fi scan program</a><br>
          <a href="https://datasheets.raspberrypi.com/picow/connecting-to-the-internet-with-pico-w.pdf">Wi-Fi connection</a><br>
          <a href="https://vanhunteradams.com/Pico/Helicopter/MotorCircuit.html">Electromagnet control circuit</a><br>
          <a href="https://github.com/vha3/Hunter-Adams-RP2040-Demos">PWM configuration and serial interface</a><br>

      </div>

    <hr id='AppendixA'>

      <div style="text-align:left;">
              <h2 class="heading2">Appendix A: Notices</h2>
              <div class="normal">
                <p>"The group approves this report for inclusion on the course website."</p>
                <p>"The group approves the video for inclusion on the course YouTube channel."</p>
              </div>
      </div>

    <hr id='AppendixB'>
      <div style="font-size:18px">
          <h2 class="heading2">Appendix B: Parts List</h2>
          <ul>
              <li><a href="https://www.adafruit.com/product/5526">Raspberry Pi Pico W</a> - $6.00 - Provided in lab</li>
              <li><a href="https://www.sparkfun.com/products/14451">SparkFun Motor Driver - Dual TB6612FNG (1A)</a> - $13.5</li>
              <li><a href="https://www.adafruit.com/product/3873">5V Electromagnet - 5 Kg Holding Force - P25/20</a> - $9.95</li>
              <li><a href="https://www.amazon.com/perseids-Chassis-Encoder-Wheels-Battery/dp/B07DNYQ3PX/ref=sr_1_3?keywords=Robot%2BCar%2BChassis%2BKit&qid=1702431911&sr=8-3&th=1">Robot Kit</a> - $19.95</li>
              <li>LEDs, MOSFETs, Resistors and Wires, etc. - Provided in lab</li>
          </ul>
          <h3>Total: $49.4</h3>
      </div>

    <hr id='AppendixC'>
      <div class="normal">
        <h2 class="heading2">Appendix C: Code</h2>
        <p>The code is shown in the repository: <a href="https://github.com/mavisfu/ECE5730_Remote_Contrlled_Robot_with_Electromagnet.git">ECE5730_Remote_Contrlled_Robot_with_Electromagnet</a></p>

        </div>


   

    </div><!-- /.container -->




    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="../../assets/js/vendor/jquery.min.js"><\/script>')</script>
    <script src="dist/js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <!-- <script src="../../assets/js/ie10-viewport-bug-workaround.js"></script> -->
  </body>
</html>
