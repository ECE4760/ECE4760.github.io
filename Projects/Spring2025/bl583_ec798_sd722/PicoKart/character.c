#include "character.h"
#include <math.h> // for ceilf()

// You need to provide these somewhere in your project
extern void fillRect(int x, int y, int w, int h, uint16_t color);
extern void drawPixel(int x, int y, uint16_t color);

// --- Cloud bitmask data ---
const uint16_t cloud_mask[CLOUD_HEIGHT] = {
    0b0000011111000000,
    0b0001111111100000,
    0b0011111111110000,
    0b0111111111111000,
    0b0011111111110000,
    0b0001111111100000,
    0b0000011111000000,
    0b0000000110000000,
};

// --- Draw scaled cloud ---
void draw_cloud_bitmask_scaled(int x, int y, uint16_t color, float ratio)
{
    for (int row = 0; row < CLOUD_HEIGHT; row++)
    {
        uint16_t line = cloud_mask[row];
        for (int col = 0; col < CLOUD_WIDTH; col++)
        {
            if (line & ((uint16_t)1 << (15 - col)))
            {
                int px_start = x + (int)(col * ratio);
                int py_start = y + (int)(row * ratio);
                int pixel_size = (int)ceilf(ratio);
                fillRect(px_start, py_start, pixel_size, pixel_size, color);
            }
        }
    }
}

// --- bear bitmask data ---
const uint64_t cow_mask[COW_HEIGHT] = {
    0b0001000010000000000000000000000000000000000000000000000000000000,
    0b0000111110000000000000000000000000000000000000000000000000000000,
    0b0001111111000000000000000000000000001111100000000000000000000000,
    0b0011111111111111111111111111111111111111000000000000000000000000,
    0b0111111111111111111111111111111111111111100000000000000000000000,
    0b1111111111111111111111111111111111111111100000000000000000000000,
    0b1111111111111111111111111111111111111111100000000000000000000000,
    0b1100011111111111111111111111111111111111100000000000000000000000,
    0b0000011111111111111111111111111111111111100000000000000000000000,
    0b0000001111111111111111111111111111111111100000000000000000000000,
    0b0000001111111111111111111111111111111111100000000000000000000000,
    0b0000000111111111111111111111111111111111100000000000000000000000,
    0b0000000111111111111111111111111111111111100000000000000000000000,
    0b0000000011111111111111111111111111111111100000000000000000000000,
    0b0000000000011110000000000011111111111110000000000000000000000000,
    0b0000000000011110000000000000001101100000000000000000000000000000,
    0b0000000000011010000000000000001001100000000000000000000000000000,
    0b0000000000011010000000000000011001100000000000000000000000000000,
    0b0000000000011010000000000000110001100000000000000000000000000000,
    0b0000000000110110000000000000110011000000000000000000000000000000,
};

// --- Draw scaled cow ---
void draw_cow_bitmask_scaled(int x, int y, uint16_t color, float ratio)
{
    for (int row = 0; row < COW_HEIGHT; row++)
    {
        uint64_t line = cow_mask[row];
        for (int col = 0; col < COW_WIDTH; col++)
        {
            if (line & ((uint64_t)1 << (63 - col)))
            {
                int scaled_x_start = x + (int)(col * ratio);
                int scaled_y_start = y + (int)(row * ratio);
                int scaled_pixel_size = (int)ceilf(ratio);
                fillRect(scaled_x_start, scaled_y_start, scaled_pixel_size, scaled_pixel_size, color);
            }
        }
    }
}

const uint64_t bear_mask[BEAR_HEIGHT] = {
    0b0000000000000000000000110000000110000000000000000000000000000,
    0b0000000000000000000001111000001110000000000000000000000000000,
    0b0000000000000000000001111111111110000000000000000000000000000,
    0b0000000000000000000000111111111110000000000000000000000000000,
    0b0000000000000000000001111111111110000000000000000000000000000,
    0b0000000000000000000011111111111110000000000000000000000000000,
    0b0000000000000000001111111111111111000000000000000000000000000,
    0b0000001111111111111111111111111111000000000000000000000000000,
    0b0000011111111111111111111111111111000000000000000000000000000,
    0b0000111111111111111111111111111111000000000000000000000000000,
    0b0001111111111111111111111111111111000000000000000000000000000,
    0b0001111111111111111111111111111110000000000000000000000000000,
    0b0011111111111111111111111111111110000000000000000000000000000,
    0b0011111111111111111111111111111000000000000000000000000000000,
    0b0111111111111111111111111111110000000000000000000000000000000,
    0b0111111111111111111111111111110000000000000000000000000000000,
    0b1111111111111111111111111111110000000000000000000000000000000,
    0b1111111111111111111111111111110000000000000000000000000000000,
    0b1111111111111111111111111111100000000000000000000000000000000,
    0b1111111111111111111111111111100000000000000000000000000000000,
    0b1111111111111111111111111111000000000000000000000000000000000,
    0b1111111111111111111111111111000000000000000000000000000000000,
    0b0111111111111111111110111111000000000000000000000000000000000,
    0b0111111111111111111100111110000000000000000000000000000000000,
    0b0111111111111011111100111110000000000000000000000000000000000,
    0b0111111111111001111100111110000000000000000000000000000000000,
    0b0011111011111001111100111100000000000000000000000000000000000,
    0b0011111011111001111100111100000000000000000000000000000000000,
    0b0011111011111101111100111110000000000000000000000000000000000,
    0b0001111111111101111110111111000000000000000000000000000000000,
    0b0001111110000000111111011111000000000000000000000000000000000,
};

void draw_bear_bitmask_scaled(int x, int y, uint16_t color, float ratio)
{
    for (int row = 0; row < BEAR_HEIGHT; row++)
    {
        uint64_t line = bear_mask[row];
        for (int col = 0; col < BEAR_WIDTH; col++)
        {
            if (line & ((uint64_t)1 << (63 - col)))
            {
                int scaled_x_start = x + (int)(col * ratio);
                int scaled_y_start = y + (int)(row * ratio);
                int scaled_pixel_size = (int)ceilf(ratio);
                fillRect(scaled_x_start, scaled_y_start, scaled_pixel_size, scaled_pixel_size, color);
            }
        }
    }
}

// --Banana bitmask data-- -
const uint64_t banana_mask[BANANA_HEIGHT] = {
    0b0000000000000001100000000000000000000000000000000000000000000,
    0b0000000000000001111000000000000000000000000000000000000000000,
    0b0000000000000001111000000000000000000000000000000000000000000,
    0b0000000000000001111000000000000000000000000000000000000000000,
    0b0000000000000111110000000000000000000000000000000000000000000,
    0b0000000000001111111000000000000000000000000000000000000000000,
    0b0000000000001111111100000000000000000000000000000000000000000,
    0b0000000000011111111100000000000000000000000000000000000000000,
    0b0000000000011111111100000000000000000000000000000000000000000,
    0b0000000000111111111100000000000000000000000000000000000000000,
    0b0001111111111111111100000000000000000000000000000000000000000,
    0b0011111111111111111111111110000000000000000000000000000000000,
    0b0011111111111111111111111110000000000000000000000000000000000,
    0b0001111111111111111111111110000000000000000000000000000000000,
    0b0000111111111111111111111100000000000000000000000000000000000,
    0b0011111111111110111111111000000000000000000000000000000000000,
    0b1111111111111100111111111111000000000000000000000000000000000,
    0b1111111111111000011111111111000000000000000000000000000000000,
    0b1111111111100000000111111111000000000000000000000000000000000,
    0b0011111100000000000001111110000000000000000000000000000000000,
};

// --- Draw scaled banana ---
void draw_banana_bitmask_scaled(int x, int y, uint16_t color, float ratio)
{
    for (int row = 0; row < BANANA_HEIGHT; row++)
    {
        uint64_t line = banana_mask[row];
        for (int col = 0; col < BANANA_WIDTH; col++)
        {
            if (line & ((uint64_t)1 << (63 - col)))
            {
                int scaled_x_start = x + (int)(col * ratio);
                int scaled_y_start = y + (int)(row * ratio);
                int scaled_pixel_size = (int)ceilf(ratio);
                fillRect(scaled_x_start, scaled_y_start, scaled_pixel_size, scaled_pixel_size, color);
            }
        }
    }
}

const uint64_t dragon_mask[DRAGON_HEIGHT] = {
    0b000000000000000000000000001000111000000000000000000000000000,
    0b000000000000000000000000011100010100000000000000000000000000,
    0b000000000000000000000000010100011110000000000000000000000000,
    0b000000000000000000000000011110011110000000000000000000000000,
    0b000000000000000000000000010010011111000000000000000000000000,
    0b000000000000000000000000011111111111111000000000000000000000,
    0b000000000000000000000000011101111111111110000000000000000000,
    0b000000000000000000000000011111111111111111000000000000000000,
    0b000000000000000000000000001111111111111111100000000000000000,
    0b000000000000000000000000001111111111111111100000000000000000,
    0b000000001100000000000000011111111111111111110000000000000000,
    0b000000011100001111000000011111111111111111110000000000000000,
    0b000000111100001111110000011111111111111111110000000000000000,
    0b000001111100000111111100011111111111111111110000000000000000,
    0b000011111000000111111110011111111111111111111000000000000000,
    0b000011111000000111111110111111111111111111111100000000000000,
    0b000111111001111111111110111111111111111111111110000000000000,
    0b000111111111111111111110111111111111111111111110000000000000,
    0b000111111011000011111110111111111111111111111110000000000000,
    0b001011111000100001111110111111111111111111111110000000000000,
    0b001111111100010001111111111111111111111111111100000000000000,
    0b001111111100010010001111111111111111111111111000000000000000,
    0b001011111110001000001111111111111110111111000000000000000000,
    0b001011111111001000001111111111111110000000000000000000000000,
    0b001111111111111111101111111111111110000000000000000000000000,
    0b001111111111111111111111111111111110000000000000000000000000,
    0b000111111111111111111111111111111111100000000000000000000000,
    0b000111111111111111111111111111111111110000000000000000000000,
    0b000111111111111111111111111111111111111000000000000000000000,
    0b000011111111111111111111111111111111111000000000000000000000,
    0b000011111111111111111111111111111111111000000000000000000000,
    0b000011111111111111111111111111111111111100000000000000000000,
    0b000111111111111111111111111111111111111100000000000000000000,
    0b000111111111111111111111111111111111111000000000000000000000,
    0b001111111111111111111111111111111110100000000000000000000000,
    0b011111111111111111111111111101111110000000000000000000000000,
    0b011100111111111111111111110001111100000000000000000000000000,
    0b011000111111111111111110000000000000000000000000000000000000,
    0b000000111001111000000000000000000000000000000000000000000000,
    0b000000110000000000000000000000000000000000000000000000000000,
};
// --- Draw scaled cloud ---
void draw_dragon_bitmask_scaled(int x, int y, uint16_t color, float ratio)
{
    for (int row = 0; row < DRAGON_HEIGHT; row++)
    {
        uint64_t line = dragon_mask[row];
        for (int col = 0; col < DRAGON_WIDTH; col++)
        {
            if (line & ((uint64_t)1 << (63 - col)))
            {
                int scaled_x_start = x + (int)(col * ratio);
                int scaled_y_start = y + (int)(row * ratio);
                int scaled_pixel_size = (int)ceilf(ratio);
                fillRect(scaled_x_start, scaled_y_start, scaled_pixel_size, scaled_pixel_size, color);
            }
        }
    }
}

const uint64_t pumpkin_mask[PUMPKIN_HEIGHT] = {
    0b000000000000111100000000000000000000000000000000000000000000,
    0b000000000000111100000000000000000000000000000000000000000000,
    0b000000000000111110100000000000000000000000000000000000000000,
    0b000000000000111111111100000000000000000000000000000000000000,
    0b000000000011111111111100000000000000000000000000000000000000,
    0b000001111111111111111100000000000000000000000000000000000000,
    0b000011111111111111111111000000000000000000000000000000000000,
    0b000111111111111111111111100000000000000000000000000000000000,
    0b001111111111111111111111100000000000000000000000000000000000,
    0b011111111111111111111111110000000000000000000000000000000000,
    0b011111111111111111111111110000000000000000000000000000000000,
    0b011111111111111111111111111000000000000000000000000000000000,
    0b011111111111111111111111111000000000000000000000000000000000,
    0b111111111111111111111111111000000000000000000000000000000000,
    0b011111111111111111111111111000000000000000000000000000000000,
    0b011111111111111111111111111000000000000000000000000000000000,
    0b011111111111111111111111110000000000000000000000000000000000,
    0b011111111111111111111111110000000000000000000000000000000000,
    0b001111111111111111111111110000000000000000000000000000000000,
    0b000111111111111111111111100000000000000000000000000000000000,
    0b000011111111111111111111000000000000000000000000000000000000,
    0b000000011111111111111100000000000000000000000000000000000000,
};

// --- Draw scaled cloud ---
void draw_pumpkin_bitmask_scaled(int x, int y, uint16_t color, float ratio)
{
    for (int row = 0; row < PUMPKIN_HEIGHT; row++)
    {
        uint64_t line = pumpkin_mask[row];
        for (int col = 0; col < PUMPKIN_WIDTH; col++)
        {
            if (line & ((uint64_t)1 << (63 - col)))
            {
                int scaled_x_start = x + (int)(col * ratio);
                int scaled_y_start = y + (int)(row * ratio);
                int scaled_pixel_size = (int)ceilf(ratio);
                fillRect(scaled_x_start, scaled_y_start, scaled_pixel_size, scaled_pixel_size, color);
            }
        }
    }
}

const uint64_t bell_mask[BELL_HEIGHT] = {
    0b000011000000000000000000000000000000000000000000000000000000,
    0b000111100000000000000000000000000000000000000000000000000000,
    0b001111110000000000000000000000000000000000000000000000000000,
    0b001111111000000000000000000000000000000000000000000000000000,
    0b011111111000000000000000000000000000000000000000000000000000,
    0b011111111000000000000000000000000000000000000000000000000000,
    0b011111111000000000000000000000000000000000000000000000000000,
    0b011111111000000000000000000000000000000000000000000000000000,
    0b011111111000000000000000000000000000000000000000000000000000,
    0b111111111100000000000000000000000000000000000000000000000000,
    0b111111111100000000000000000000000000000000000000000000000000,
    0b000011000000000000000000000000000000000000000000000000000000,
};

// --- Draw scaled cloud ---
void draw_bell_bitmask_scaled(int x, int y, uint16_t color, float ratio)
{
    for (int row = 0; row < BELL_HEIGHT; row++)
    {
        uint64_t line = bell_mask[row];
        for (int col = 0; col < BELL_WIDTH; col++)
        {
            if (line & ((uint64_t)1 << (63 - col)))
            {
                int scaled_x_start = x + (int)(col * ratio);
                int scaled_y_start = y + (int)(row * ratio);
                int scaled_pixel_size = (int)ceilf(ratio);
                fillRect(scaled_x_start, scaled_y_start, scaled_pixel_size, scaled_pixel_size, color);
            }
        }
    }
}